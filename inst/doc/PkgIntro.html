<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wenbo Lv" />


<title>Introduction to the spEDM package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the spEDM package</h1>
<h4 class="author">Wenbo Lv</h4>
<h4 class="date"><div class="line-block">Last update: 2025-08-31<br />
Last run: 2025-08-31</div></h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The <em>spEDM</em> package is an open-source, computationally
efficient toolkit designed to provide a unified API for <strong>Spatial
Empirical Dynamic Modeling</strong>. It supports a suite of
prediction-based causal discovery algorithms, including <em>spatial
(granger) causality test</em>, <em>geographically convergent cross
mapping</em>, and <em>geographical cross mapping cardinality</em>.</p>
<p>To support both learning and practical application, <em>spEDM</em>
offers four carefully curated spatial cross-sectional datasets, each
paired with a detailed example showcasing the use of key algorithms in
the package.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Install the stable version from <a href="https://CRAN.R-project.org/package=spEDM">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spEDM&quot;</span>, <span class="at">dep =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Alternatively, you can install the development version from <a href="https://stscl.r-universe.dev/spEDM">R-universe</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spEDM&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">&quot;https://stscl.r-universe.dev&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                           <span class="st">&quot;https://cloud.r-project.org&quot;</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                 <span class="at">dep =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The <em>spEDM</em> package includes four illustrative datasets with
well-known causation to demonstrate key functionalities:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Columbus, OH</strong> dataset — A classic spatial dataset
widely used in spatial econometrics, included here for benchmarking and
demonstration purposes. <em>Data files</em>:
<code>columbus.gpkg</code></p></li>
<li><p><strong>Population density and its potential drivers in mainland
China</strong> — A county-level dataset capturing population density
alongside relevant socio-environmental drivers. <em>Data files</em>:
<code>popd.csv</code>, <code>popd_nb.gal</code></p></li>
<li><p><strong>Soil copper (Cu) contamination</strong> — A raster-based
dataset representing soil Cu concentrations, with associated layers on
nighttime light intensity and industrial density, useful for exploring
the influence of human activities on environmental pollution. <em>Data
files</em>: <code>cu.tif</code></p></li>
<li><p><strong>Farmland NPP and related variables</strong> — A raster
dataset capturing net primary productivity (NPP) of farmland, key
climatic variables, elevation, and human activity footprints across
mainland China, suitable for analyzing the interactions between
agricultural productivity, environmental conditions, and human
activities. <em>Data files</em>: <code>npp.tif</code></p></li>
</ol>
<p>These datasets can be loaded as shown below:</p>
<div id="columbus-oh-spatial-analysis-dataset" class="section level3">
<h3>Columbus OH spatial analysis dataset</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(spEDM)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>columbus <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="fu">system.file</span>(<span class="st">&quot;case/columbus.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;spEDM&quot;</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>columbus</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## Simple feature collection with 49 features and 6 fields</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## Geometry type: POLYGON</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## Dimension:     XY</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">## Bounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## Projected CRS: Undefined Cartesian SRS with unknown unit</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">## # A tibble: 49 × 7</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="do">##    hoval   inc  crime  open plumb discbd                                     geom</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;                                &lt;POLYGON&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="do">##  1  80.5 19.5  15.7   2.85  0.217   5.03 ((8.624129 14.23698, 8.5597 14.74245, 8…</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="do">##  2  44.6 21.2  18.8   5.30  0.321   4.27 ((8.25279 14.23694, 8.282758 14.22994, …</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="do">##  3  26.4 16.0  30.6   4.53  0.374   3.89 ((8.653305 14.00809, 8.81814 14.00205, …</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="do">##  4  33.2  4.48 32.4   0.394 1.19    3.7  ((8.459499 13.82035, 8.473408 13.83227,…</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="do">##  5  23.2 11.3  50.7   0.406 0.625   2.83 ((8.685274 13.63952, 8.677577 13.72221,…</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="do">##  6  28.8 16.0  26.1   0.563 0.254   3.78 ((9.401384 13.5504, 9.434411 13.69427, …</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="do">##  7  75    8.44  0.178 0     2.40    2.74 ((8.037741 13.60752, 8.062716 13.60452,…</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="do">##  8  37.1 11.3  38.4   3.48  2.74    2.89 ((8.247527 13.58651, 8.2795 13.5965, 8.…</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="do">##  9  52.6 17.6  30.5   0.527 0.891   3.17 ((9.333297 13.27242, 9.671007 13.27361,…</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="do">## 10  96.4 13.6  34.0   1.55  0.558   4.33 ((10.08251 13.03377, 10.0925 13.05275, …</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="do">## # ℹ 39 more rows</span></span></code></pre></div>
</div>
<div id="county-level-population-density-in-mainland-china" class="section level3">
<h3>County-level population density in mainland China</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(spEDM)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>popd_nb <span class="ot">=</span> spdep<span class="sc">::</span><span class="fu">read.gal</span>(<span class="fu">system.file</span>(<span class="st">&quot;case/popd_nb.gal&quot;</span>,<span class="at">package =</span> <span class="st">&quot;spEDM&quot;</span>))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">## Warning in spdep::read.gal(system.file(&quot;case/popd_nb.gal&quot;, package = &quot;spEDM&quot;)):</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">## neighbour object has 4 sub-graphs</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>popd_nb</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">## Neighbour list object:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">## Number of regions: 2806 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="do">## Number of nonzero links: 15942 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="do">## Percentage nonzero weights: 0.2024732 </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">## Average number of links: 5.681397 </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="do">## 4 disjoint connected subgraphs</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>popd <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;case/popd.csv&quot;</span>,<span class="at">package =</span> <span class="st">&quot;spEDM&quot;</span>))</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="do">## Rows: 2806 Columns: 7</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="do">## ── Column specification ─────────────────────────────────────────────────────────</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="do">## Delimiter: &quot;,&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="do">## dbl (7): lon, lat, popd, elev, tem, pre, slope</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="do">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="do">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>popd</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="do">## # A tibble: 2,806 × 7</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="do">##      lon   lat  popd  elev   tem   pre slope</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="do">##  1  117.  30.5  780.     8  17.4 1528. 0.452</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="do">##  2  117.  30.6  395.    48  17.2 1487. 0.842</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="do">##  3  117.  30.8  261.    49  16.0 1456. 3.56 </span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="do">##  4  116.  30.1  258.    23  17.4 1555. 0.932</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="do">##  5  116.  30.5  211.   101  16.3 1494. 3.34 </span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="do">##  6  117.  31.0  386.    10  16.6 1382. 1.65 </span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="do">##  7  117.  30.2  350.    23  17.5 1569. 0.346</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="do">##  8  117.  30.7  470.    22  17.1 1493. 1.88 </span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="do">##  9  117.  30.6 1226.    11  17.4 1526. 0.208</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="do">## 10  116.  30.9  137.   598  13.9 1458. 5.92 </span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="do">## # ℹ 2,796 more rows</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>popd_sf <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(popd, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>popd_sf</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="do">## Simple feature collection with 2806 features and 5 fields</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="do">## Geometry type: POINT</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="do">## Dimension:     XY</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="do">## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="do">## Geodetic CRS:  WGS 84</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="do">## # A tibble: 2,806 × 6</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="do">##     popd  elev   tem   pre slope          geometry</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="do">##  * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;POINT [°]&gt;</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="do">##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879)</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="do">##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877)</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="do">##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548)</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="do">##  4  258.    23  17.4 1555. 0.932  (116.241 30.104)</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="do">##  5  211.   101  16.3 1494. 3.34   (116.173 30.495)</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="do">##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839)</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="do">##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412)</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="do">##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514)</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="do">##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558)</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="do">## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983)</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="do">## # ℹ 2,796 more rows</span></span></code></pre></div>
</div>
<div id="soil-cu-heavy-metal-contamination" class="section level3">
<h3>Soil Cu heavy metal contamination</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(spEDM)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>cu <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;case/cu.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;spEDM&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>cu</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## size        : 131, 125, 3  (nrow, ncol, nlyr)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## resolution  : 5000, 5000  (x, y)</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## extent      : 360000, 985000, 1555000, 2210000  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## coord. ref. : North_American_1983_Albers </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## source      : cu.tif </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## names       :         cu, industry, ntl </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">## min values  :   1.201607,    0.000,   0 </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## max values  : 319.599274,    0.615,  63</span></span></code></pre></div>
</div>
<div id="farmland-npp-and-related-variables-in-mainland-china" class="section level3">
<h3>Farmland NPP and related variables in mainland China</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(spEDM)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>npp <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;case/npp.tif&quot;</span>, <span class="at">package =</span> <span class="st">&quot;spEDM&quot;</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>npp</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="do">## size        : 404, 483, 5  (nrow, ncol, nlyr)</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">## resolution  : 10000, 10000  (x, y)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="do">## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="do">## coord. ref. : CGCS2000_Albers </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="do">## source      : npp.tif </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="do">## names       :      npp,        pre,      tem,      elev,         hfp </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="do">## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418 </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="do">## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195</span></span></code></pre></div>
</div>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>Users can refer to several additional vignettes for more detailed
examples of using <em>spEDM</em>, namely:</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th><em>Method</em></th>
<th><em>Vignette</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>State Space Reconstruction</td>
<td><a href="https://stscl.github.io/spEDM/articles/SSR.html">SSR</a></td>
</tr>
<tr class="even">
<td>Spatial Logistic Map</td>
<td><a href="https://stscl.github.io/spEDM/articles/SLM.html">SLM</a></td>
</tr>
<tr class="odd">
<td>Geographical Convergent Cross Mapping</td>
<td><a href="https://stscl.github.io/spEDM/articles/GCCM.html">GCCM</a></td>
</tr>
<tr class="even">
<td>Geographical Cross Mapping Cardinality</td>
<td><a href="https://stscl.github.io/spEDM/articles/GCMC.html">GCMC</a></td>
</tr>
<tr class="odd">
<td>Spatial Causality Test</td>
<td><a href="https://stscl.github.io/spEDM/articles/SCT.html">SCT</a></td>
</tr>
</tbody>
</table>
<p>In addition to the spatial extensions provided by <em>spEDM</em>,
several other R packages support Empirical Dynamic Modeling (EDM) for
<strong>time series data</strong>:</p>
<ul>
<li><strong><a href="https://stscl.github.io/tEDM/">tEDM</a></strong>:
An R package developed by the author of <code>spEDM</code>, designed to
implement the <strong>Temporal Empirical Dynamic Modeling</strong>
framework. It aims for maximal consistency with <code>spEDM</code> in
terms of API design and modeling workflow, facilitating seamless
transition between spatial and temporal EDM applications.</li>
<li><strong><a href="https://cran.r-project.org/package=rEDM">rEDM</a></strong>: A
foundational EDM package implementing simplex projection, S-map, and
convergent cross mapping (CCM), widely used for analyzing nonlinear time
series dynamics.</li>
<li><strong><a href="https://cran.r-project.org/package=multispatialCCM">multispatialCCM</a></strong>:
Implements CCM for collections of short time series using bootstrapping,
enabling causal inference across replicated or multi-site time
series.</li>
<li><strong><a href="https://edm-developers.github.io/fastEDM-r/">fastEDM</a></strong>:
A high-performance EDM package with a multi-threaded C++ backend. It
supports large-scale time series analysis, handles panel data, and
provides robust options for dealing with missing values using
delay-tolerant algorithms or data exclusion.</li>
</ul>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Takens, F. (1981). Detecting strange attractors in turbulence.
Dynamical Systems and Turbulence, Warwick 1980, 366–381. <a href="https://doi.org/10.1007/bfb0091924" class="uri">https://doi.org/10.1007/bfb0091924</a></p>
<p>Mañé, R. (1981). On the dimension of the compact invariant sets of
certain non-linear maps. Dynamical Systems and Turbulence, Warwick 1980,
230–242. <a href="https://doi.org/10.1007/bfb0091916" class="uri">https://doi.org/10.1007/bfb0091916</a></p>
<p>Willeboordse, F.H., 2003. The spatial logistic map as a simple
prototype for spatiotemporal chaos. Chaos: An Interdisciplinary Journal
of Nonlinear Science 13, 533–540. <a href="https://doi.org/10.1063/1.1568692" class="uri">https://doi.org/10.1063/1.1568692</a></p>
<p>Herrera, M., Mur, J., &amp; Ruiz, M. (2016). Detecting causal
relationships between spatial processes. Papers in Regional Science,
95(3), 577–595. <a href="https://doi.org/10.1111/pirs.12144" class="uri">https://doi.org/10.1111/pirs.12144</a></p>
<p>Gao, B., Yang, J., Chen, Z., Sugihara, G., Li, M., Stein, A., Kwan,
M.-P., &amp; Wang, J. (2023). Causal inference from cross-sectional
earth system data with geographical convergent cross mapping. Nature
Communications, 14(1). <a href="https://doi.org/10.1038/s41467-023-41619-6" class="uri">https://doi.org/10.1038/s41467-023-41619-6</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
